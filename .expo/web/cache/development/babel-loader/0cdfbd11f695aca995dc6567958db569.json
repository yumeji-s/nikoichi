{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"source\", \"src\", \"fallbackElement\", \"alt\", \"fallbackSource\", \"ignoreFallback\", \"_alt\"];\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { useState, memo, forwardRef, useCallback, useRef } from 'react';\nimport RNImage from \"react-native-web/dist/exports/Image\";\nimport Text from \"../Text\";\nimport { usePropsResolution } from \"../../../hooks/useThemeProps\";\nimport { useHasResponsiveProps } from \"../../../hooks/useHasResponsiveProps\";\nimport { makeStyledComponent } from \"../../../utils/styled\";\nvar StyledImage = makeStyledComponent(RNImage);\n\nvar Image = function Image(props, ref) {\n  var _usePropsResolution = usePropsResolution('Image', props),\n      source = _usePropsResolution.source,\n      src = _usePropsResolution.src,\n      fallbackElement = _usePropsResolution.fallbackElement,\n      alt = _usePropsResolution.alt,\n      fallbackSource = _usePropsResolution.fallbackSource,\n      ignoreFallback = _usePropsResolution.ignoreFallback,\n      _alt = _usePropsResolution._alt,\n      resolvedProps = _objectWithoutProperties(_usePropsResolution, _excluded);\n\n  var finalSource = useRef(null);\n  var getSource = useCallback(function () {\n    if (source) {\n      finalSource.current = source;\n    } else if (src) {\n      finalSource.current = {\n        uri: src\n      };\n    }\n\n    return finalSource.current;\n  }, [source, src]);\n\n  var _useState = useState(getSource()),\n      _useState2 = _slicedToArray(_useState, 2),\n      renderedSource = _useState2[0],\n      setSource = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      alternate = _useState4[0],\n      setAlternate = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      fallbackSourceFlag = _useState6[0],\n      setfallbackSourceFlag = _useState6[1];\n\n  React.useEffect(function () {\n    return function () {\n      finalSource.current = null;\n    };\n  }, [source, src, getSource]);\n  var onImageLoadError = useCallback(function (event) {\n    props.onError && props.onError(event);\n    console.warn(event.nativeEvent.error);\n\n    if (!ignoreFallback && fallbackSource && fallbackSource !== renderedSource && fallbackSourceFlag) {\n      setfallbackSourceFlag(false);\n      setSource(fallbackSource);\n    } else {\n      setAlternate(true);\n    }\n  }, [fallbackSource, fallbackSourceFlag, ignoreFallback, props, renderedSource]);\n\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n\n  if (!alt) {\n    console.warn('Please pass alt prop to Image component');\n  }\n\n  if (alternate) {\n    if (fallbackElement) {\n      if (React.isValidElement(fallbackElement)) {\n        return fallbackElement;\n      }\n    } else return React.createElement(Text, _alt, alt);\n  }\n\n  return React.createElement(StyledImage, _extends({\n    source: renderedSource,\n    accessibilityLabel: alt,\n    alt: alt\n  }, resolvedProps, {\n    onError: onImageLoadError,\n    ref: ref\n  }));\n};\n\nexport default memo(forwardRef(Image));","map":{"version":3,"sources":["index.tsx"],"names":["StyledImage","makeStyledComponent","Image","resolvedProps","usePropsResolution","finalSource","useRef","getSource","useCallback","uri","src","useState","React","onImageLoadError","event","props","console","fallbackSource","setfallbackSourceFlag","setSource","setAlternate","useHasResponsiveProps","alt","ref","memo","forwardRef"],"mappings":"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","sourcesContent":["import React, { useState, memo, forwardRef, useCallback, useRef } from 'react';\nimport { Image as RNImage } from 'react-native';\nimport Text from '../Text';\nimport { usePropsResolution } from '../../../hooks/useThemeProps';\nimport type { IImageProps } from './types';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\nimport { makeStyledComponent } from '../../../utils/styled';\n\nconst StyledImage = makeStyledComponent(RNImage);\n\nconst Image = (props: IImageProps, ref: any) => {\n  const {\n    source,\n    src,\n    fallbackElement,\n    alt,\n    fallbackSource,\n    ignoreFallback,\n    _alt,\n    ...resolvedProps\n  } = usePropsResolution('Image', props);\n\n  const finalSource: any = useRef(null);\n  const getSource = useCallback(() => {\n    if (source) {\n      finalSource.current = source;\n    } else if (src) {\n      finalSource.current = { uri: src };\n    }\n    return finalSource.current;\n  }, [source, src]);\n\n  const [renderedSource, setSource] = useState(getSource());\n  const [alternate, setAlternate] = useState(false);\n  const [fallbackSourceFlag, setfallbackSourceFlag] = useState(true);\n\n  React.useEffect(() => {\n    return () => {\n      finalSource.current = null;\n    };\n  }, [source, src, getSource]);\n\n  const onImageLoadError = useCallback(\n    (event: any) => {\n      props.onError && props.onError(event);\n      console.warn(event.nativeEvent.error);\n      if (\n        !ignoreFallback &&\n        fallbackSource &&\n        fallbackSource !== renderedSource &&\n        fallbackSourceFlag\n      ) {\n        setfallbackSourceFlag(false);\n        setSource(fallbackSource);\n      } else {\n        setAlternate(true);\n      }\n    },\n    [fallbackSource, fallbackSourceFlag, ignoreFallback, props, renderedSource]\n  );\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n  if (!alt) {\n    console.warn('Please pass alt prop to Image component');\n  }\n\n  if (alternate) {\n    if (fallbackElement) {\n      if (React.isValidElement(fallbackElement)) {\n        return fallbackElement;\n      }\n    } else return <Text {..._alt}>{alt}</Text>;\n  }\n  return (\n    <StyledImage\n      source={renderedSource}\n      accessibilityLabel={alt}\n      alt={alt}\n      {...resolvedProps}\n      onError={onImageLoadError}\n      ref={ref}\n    />\n  );\n};\n\nexport default memo(forwardRef(Image));\nexport type { IImageProps };\n"]},"metadata":{},"sourceType":"module"}